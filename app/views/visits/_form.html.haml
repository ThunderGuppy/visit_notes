= form_for @visit do |f|
  - if @visit.errors.any?
    #error_explanation
      %h2= "#{pluralize(@visit.errors.count, "error")} prohibited this visit from being saved:"
      %ul
        - @visit.errors.full_messages.each do |message|
          %li= message
  %p
  =f.date_field :date
  %p
  =f.text_area :notes
  %p
  %h5
    Trials:
  %div{id: 'fieldsetContainer'}
    = f.fields_for :trials do |b|
      %fieldset{id: 0}
        = b.text_field :topic

  .button{:id => 'addTrial', onclick: "addTrial();"}
    = fa_icon "plus"
    Trial

  %p
  .actions
    = f.submit 'Save', {class: 'button'}


:javascript

    const createButton = document.getElementById("addTrial");
    createButton.addEventListener("click", () => {

        const lastId = document.querySelector('#fieldsetContainer').lastElementChild.value;

        const newId = parseInt(lastId, 10) + 1;

        const newFieldset = document.querySelector('[id="0"]').outerHTML.replace(/0/g,newId);

        document.querySelector("#fieldsetContainer").insertAdjacentHTML(
        "beforeend", newFieldset
        );
    });
